Using TensorFlow backend.
2018-02-27 10:55:23.376091: E tensorflow/stream_executor/cuda/cuda_driver.cc:406] failed call to cuInit: CUDA_ERROR_UNKNOWN
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
gru_1 (GRU)                  (1, None, 300)            271800    
_________________________________________________________________
dropout_1 (Dropout)          (1, None, 300)            0         
_________________________________________________________________
dense_1 (Dense)              (1, None, 1)              301       
=================================================================
Total params: 272,101
Trainable params: 272,101
Non-trainable params: 0
_________________________________________________________________
None
17520.0
  0%|          | 0/1 [00:00<?, ?it/s]Epoch 1/100
 - 4s - loss: 0.9672
Epoch 2/100
 - 4s - loss: 0.9265
Epoch 3/100
 - 4s - loss: 0.9226
Epoch 4/100
 - 4s - loss: 0.8979
Epoch 5/100
 - 4s - loss: 0.8802
Epoch 6/100
 - 4s - loss: 0.8538
Epoch 7/100
 - 4s - loss: 0.8391
Epoch 8/100
 - 4s - loss: 0.8188
Epoch 9/100
 - 4s - loss: 0.7843
Epoch 10/100
 - 4s - loss: 0.7855
Epoch 11/100
 - 4s - loss: 0.7650
Epoch 12/100
 - 4s - loss: 0.7559
Epoch 13/100
 - 4s - loss: 0.7478
Epoch 14/100
 - 4s - loss: 0.7341
Epoch 15/100
 - 4s - loss: 0.7087
Epoch 16/100
 - 4s - loss: 0.6987
Epoch 17/100
 - 4s - loss: 0.6999
Epoch 18/100
 - 4s - loss: 0.6898
Epoch 19/100
 - 4s - loss: 0.6808
Epoch 20/100
 - 4s - loss: 0.6648
Epoch 21/100
 - 4s - loss: 0.6562
Epoch 22/100
 - 4s - loss: 0.6444
Epoch 23/100
 - 4s - loss: 0.6423
Epoch 24/100
 - 4s - loss: 0.6330
Epoch 25/100
 - 4s - loss: 0.6279
Epoch 26/100
 - 4s - loss: 0.6194
Epoch 27/100
 - 4s - loss: 0.6068
Epoch 28/100
 - 4s - loss: 0.6042
Epoch 29/100
 - 4s - loss: 0.5958
Epoch 30/100
 - 4s - loss: 0.5913
Epoch 31/100
 - 4s - loss: 0.5790
Epoch 32/100
 - 4s - loss: 0.5714
Epoch 33/100
 - 4s - loss: 0.5605
Epoch 34/100
 - 4s - loss: 0.5576
Epoch 35/100
 - 4s - loss: 0.5598
Epoch 36/100
 - 4s - loss: 0.5507
Epoch 37/100
 - 4s - loss: 0.5446
Epoch 38/100
 - 4s - loss: 0.5313
Epoch 39/100
 - 4s - loss: 0.5310
Epoch 40/100
 - 4s - loss: 0.5280
Epoch 41/100
 - 4s - loss: 0.5222
Epoch 42/100
 - 4s - loss: 0.5215
Epoch 43/100
 - 4s - loss: 0.5151
Epoch 44/100
 - 4s - loss: 0.5158
Epoch 45/100
 - 4s - loss: 0.5083
Epoch 46/100
 - 4s - loss: 0.5045
Epoch 47/100
 - 4s - loss: 0.4974
Epoch 48/100
 - 4s - loss: 0.4978
Epoch 49/100
 - 4s - loss: 0.4884
Epoch 50/100
 - 4s - loss: 0.4859
Epoch 51/100
 - 4s - loss: 0.4813
Epoch 52/100
 - 4s - loss: 0.4762
Epoch 53/100
 - 4s - loss: 0.4804
Epoch 54/100
 - 4s - loss: 0.4685
Epoch 55/100
 - 4s - loss: 0.4701
Epoch 56/100
 - 4s - loss: 0.4694
Epoch 57/100
 - 4s - loss: 0.4699
Epoch 58/100
 - 4s - loss: 0.4659
Epoch 59/100
 - 4s - loss: 0.4593
Epoch 60/100
 - 4s - loss: 0.4562
Epoch 61/100
 - 4s - loss: 0.4555
Epoch 62/100
 - 4s - loss: 0.4502
Epoch 63/100
 - 4s - loss: 0.4522
Epoch 64/100
 - 4s - loss: 0.4474
Epoch 65/100
 - 4s - loss: 0.4468
Epoch 66/100
 - 4s - loss: 0.4374
Epoch 67/100
 - 4s - loss: 0.4396
Epoch 68/100
 - 4s - loss: 0.4339
Epoch 69/100
 - 4s - loss: 0.4366
Epoch 70/100
 - 4s - loss: 0.4348
Epoch 71/100
 - 4s - loss: 0.4329
Epoch 72/100
 - 4s - loss: 0.4288
Epoch 73/100
 - 4s - loss: 0.4292
Epoch 74/100
 - 4s - loss: 0.4273
Epoch 75/100
 - 4s - loss: 0.4270
Epoch 76/100
 - 4s - loss: 0.4250
Epoch 77/100
 - 4s - loss: 0.4243
Epoch 78/100
 - 4s - loss: 0.4199
Epoch 79/100
 - 4s - loss: 0.4222
Epoch 80/100
 - 4s - loss: 0.4171
Epoch 81/100
 - 4s - loss: 0.4169
Epoch 82/100
 - 4s - loss: 0.4112
Epoch 83/100
 - 4s - loss: 0.4098
Epoch 84/100
 - 4s - loss: 0.4096
Epoch 85/100
 - 4s - loss: 0.4124
Epoch 86/100
 - 4s - loss: 0.4103
Epoch 87/100
 - 4s - loss: 0.4102
Epoch 88/100
 - 4s - loss: 0.4084
Epoch 89/100
 - 4s - loss: 0.4184
Epoch 90/100
 - 4s - loss: 0.4144
Epoch 91/100
 - 4s - loss: 0.4130
Epoch 92/100
 - 4s - loss: 0.4026
Epoch 93/100
 - 4s - loss: 0.4033
Epoch 94/100
 - 4s - loss: 0.4071
Epoch 95/100
 - 4s - loss: 0.4050
Epoch 96/100
 - 4s - loss: 0.3980
Epoch 97/100
 - 4s - loss: 0.3981
Epoch 98/100
 - 4s - loss: 0.4066
Epoch 99/100
 - 4s - loss: 0.4018
Epoch 100/100
 - 4s - loss: 0.3942

Traceback (most recent call last):
  File "run_gru_nyc.py", line 30, in <module>
    mase = run_gru(settings)
  File "/root/virtualenv/htm/timeseries-comparison/projects/sequence_prediction/continuous_sequence/run_gru_tf_stateful.py", line 438, in run_gru
    lstm.reset_states()
UnboundLocalError: local variable 'lstm' referenced before assignment
